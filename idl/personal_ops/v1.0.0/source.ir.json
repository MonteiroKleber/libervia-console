{
  "actors": [
    {
      "auth": "oauth2",
      "description": "Proprietario da instituicao. Criado no onboarding. Pode operar arquivos e decidir approvals.",
      "id": "inst_owner",
      "kind": "human",
      "name": "Institution Owner",
      "permissions": [
        "files.list",
        "files.scan",
        "files.suggest",
        "files.read",
        "files.stat",
        "files.hash",
        "files.search",
        "files.rename",
        "files.move",
        "files.delete",
        "files.plan.create",
        "files.plan.get",
        "files.plan.apply",
        "archive.create",
        "jobs.get",
        "approval.decide"
      ]
    },
    {
      "auth": "oauth2",
      "description": "Administrador executivo. Pode decidir approvals para acoes destrutivas.",
      "id": "exec_admin",
      "kind": "human",
      "name": "Executive Admin",
      "permissions": [
        "files.list",
        "files.scan",
        "files.suggest",
        "jobs.get",
        "approval.decide"
      ]
    },
    {
      "auth": "token",
      "description": "Agente LLM governado que executa operacoes aprovadas via Runtime.",
      "id": "runtime_agent",
      "kind": "system",
      "name": "Agent Runtime",
      "permissions": [
        "files.list",
        "files.scan",
        "files.suggest",
        "files.read",
        "files.stat",
        "files.hash",
        "files.search",
        "files.rename",
        "files.move",
        "files.delete",
        "files.plan.create",
        "files.plan.get",
        "files.plan.apply",
        "archive.create",
        "jobs.get",
        "jobs.enqueue",
        "runtime.bundle.load",
        "runtime.proof.snapshot",
        "runtime.safe_mode.enter"
      ]
    }
  ],
  "approval_rules": [
    {
      "approver_roles": [
        "inst_owner",
        "exec_admin"
      ],
      "name": "job_files_delete_requires_approval",
      "quorum": 1,
      "trigger": {
        "api": "POST /personal/jobs/files/delete"
      }
    },
    {
      "approver_roles": [
        "inst_owner",
        "exec_admin"
      ],
      "name": "job_files_rename_requires_approval",
      "quorum": 1,
      "trigger": {
        "api": "POST /personal/jobs/files/rename"
      }
    },
    {
      "approver_roles": [
        "inst_owner",
        "exec_admin"
      ],
      "name": "job_files_move_requires_approval",
      "quorum": 1,
      "trigger": {
        "api": "POST /personal/jobs/files/move"
      }
    },
    {
      "approver_roles": [
        "inst_owner",
        "exec_admin"
      ],
      "name": "job_files_plan_apply_requires_approval",
      "quorum": 1,
      "trigger": {
        "api": "POST /personal/jobs/files/plan/{plan_id}/apply"
      }
    }
  ],
  "department": {
    "dept_id": "personal_ops",
    "entrypoints": {
      "api_prefix": "/personal_ops",
      "event_prefix": "personal_ops.",
      "permission_prefix": "personal_ops."
    },
    "name": "Personal Ops",
    "namespace": "personal_ops",
    "tenancy": "multi"
  },
  "entities": [],
  "invariants": [],
  "ir_version": "ircs.v1",
  "operations": {
    "api": [
      {
        "bind": {
          "entity": "",
          "job_type": "files.list",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403
        ],
        "id": "job_files_list",
        "idempotency": "none",
        "method": "POST",
        "path": "/personal/jobs/files/list",
        "path_params": [],
        "permission": "files.list",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "job_type": "files.scan",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403
        ],
        "id": "job_files_scan",
        "idempotency": "none",
        "method": "POST",
        "path": "/personal/jobs/files/scan",
        "path_params": [],
        "permission": "files.scan",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "job_type": "files.suggest",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403
        ],
        "id": "job_files_suggest",
        "idempotency": "none",
        "method": "POST",
        "path": "/personal/jobs/files/suggest",
        "path_params": [],
        "permission": "files.suggest",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "job_type": "files.read",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403
        ],
        "id": "job_files_read",
        "idempotency": "none",
        "method": "POST",
        "path": "/personal/jobs/files/read",
        "path_params": [],
        "permission": "files.read",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "job_type": "files.stat",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403
        ],
        "id": "job_files_stat",
        "idempotency": "none",
        "method": "POST",
        "path": "/personal/jobs/files/stat",
        "path_params": [],
        "permission": "files.stat",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "job_type": "files.hash",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403
        ],
        "id": "job_files_hash",
        "idempotency": "none",
        "method": "POST",
        "path": "/personal/jobs/files/hash",
        "path_params": [],
        "permission": "files.hash",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "job_type": "files.search",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403
        ],
        "id": "job_files_search",
        "idempotency": "none",
        "method": "POST",
        "path": "/personal/jobs/files/search",
        "path_params": [],
        "permission": "files.search",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "job_type": "files.plan.create",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403
        ],
        "id": "job_files_plan_create",
        "idempotency": "none",
        "method": "POST",
        "path": "/personal/jobs/files/plan/create",
        "path_params": [],
        "permission": "files.plan.create",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "job_type": "files.plan.get",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403,
          404
        ],
        "id": "job_files_plan_get",
        "idempotency": "none",
        "method": "POST",
        "path": "/personal/jobs/files/plan/get",
        "path_params": [],
        "permission": "files.plan.get",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "job_type": "files.plan.apply",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403,
          404,
          409
        ],
        "id": "job_files_plan_apply",
        "idempotency": "required",
        "method": "POST",
        "path": "/personal/jobs/files/plan/{plan_id}/apply",
        "path_params": [
          "plan_id"
        ],
        "permission": "files.plan.apply",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "job_type": "archive.create",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403
        ],
        "id": "job_archive_create",
        "idempotency": "none",
        "method": "POST",
        "path": "/personal/jobs/archive/create",
        "path_params": [],
        "permission": "archive.create",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "job_type": "files.rename",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403
        ],
        "id": "job_files_rename",
        "idempotency": "none",
        "method": "POST",
        "path": "/personal/jobs/files/rename",
        "path_params": [],
        "permission": "files.rename",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "job_type": "files.move",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403
        ],
        "id": "job_files_move",
        "idempotency": "none",
        "method": "POST",
        "path": "/personal/jobs/files/move",
        "path_params": [],
        "permission": "files.move",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "job_type": "files.delete",
          "kind": "job.request"
        },
        "errors": [
          400,
          401,
          403
        ],
        "id": "job_files_delete",
        "idempotency": "none",
        "method": "POST",
        "path": "/personal/jobs/files/delete",
        "path_params": [],
        "permission": "files.delete",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "kind": "job.get"
        },
        "errors": [
          400,
          401,
          403,
          404
        ],
        "id": "job_get",
        "idempotency": "none",
        "method": "GET",
        "path": "/personal/jobs/{job_id}",
        "path_params": [
          "job_id"
        ],
        "permission": "jobs.get",
        "request_type": "void",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "kind": "job.enqueue"
        },
        "errors": [
          400,
          401,
          403,
          404,
          409
        ],
        "id": "job_enqueue",
        "idempotency": "required",
        "method": "POST",
        "path": "/personal/jobs/{job_id}/enqueue",
        "path_params": [
          "job_id"
        ],
        "permission": "jobs.enqueue",
        "request_type": "void",
        "response_type": "any",
        "scope": "tenant"
      },
      {
        "bind": {
          "entity": "",
          "kind": "approval"
        },
        "errors": [
          400,
          401,
          403,
          404,
          409
        ],
        "id": "approval_decide",
        "idempotency": "required",
        "method": "POST",
        "path": "/approvals/{approval_id}/decide",
        "path_params": [
          "approval_id"
        ],
        "permission": "approval.decide",
        "request_type": "any",
        "response_type": "any",
        "scope": "tenant"
      }
    ]
  },
  "policy_context": {
    "schema": [
      {
        "name": "jurisdiction",
        "required": true,
        "type": "string"
      },
      {
        "default": "low",
        "name": "risk_level",
        "required": false,
        "type": "string"
      },
      {
        "default": "normal",
        "name": "file_sensitivity",
        "required": false,
        "type": "string"
      }
    ]
  },
  "runtime": {
    "gate_order": [
      "safe_mode",
      "rbac",
      "policy_pre",
      "sod",
      "workflow",
      "invariants",
      "commit",
      "policy_post",
      "ledger_finalize"
    ],
    "proof": {
      "snapshot_enabled": true
    },
    "safe_mode": {
      "enabled": true,
      "on_contract_tamper": "enter",
      "on_invariant_violation": "enter"
    }
  },
  "separation_of_duties": [
    {
      "case_step": "APPROVAL:job_files_delete_requires_approval",
      "constraint": "REQUESTER_NEQ_DECIDER",
      "name": "no_self_approval_job_files_delete"
    },
    {
      "case_step": "APPROVAL:job_files_rename_requires_approval",
      "constraint": "REQUESTER_NEQ_DECIDER",
      "name": "no_self_approval_job_files_rename"
    },
    {
      "case_step": "APPROVAL:job_files_move_requires_approval",
      "constraint": "REQUESTER_NEQ_DECIDER",
      "name": "no_self_approval_job_files_move"
    },
    {
      "case_step": "APPROVAL:job_files_plan_apply_requires_approval",
      "constraint": "REQUESTER_NEQ_DECIDER",
      "name": "no_self_approval_job_files_plan_apply"
    }
  ],
  "source_idl_sha256": "cefe472044e0eeff1c7254581bbc298032fe6e507b707605dea326979b711a78",
  "source_idl_version": "idl.v1.2.2",
  "system": {
    "contact": "ops@libervia.xyz",
    "description": "Governanca de operacoes pessoais de arquivos via Jobs First-Class. Acoes destrutivas requerem approval.",
    "domain": "personal_ops",
    "id": "PersonalOps",
    "name": "Personal Ops",
    "owner": "Libervia"
  },
  "workflows": []
}